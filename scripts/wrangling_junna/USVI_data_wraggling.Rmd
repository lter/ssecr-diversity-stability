---
title: "USVI_TCRMP"
output: pdf_document
date: "2025-01-20"
author: "Junna Wang"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r benthic cover}
library(librarian)
# Install missing packages and load needed libraries
shelf(tidyverse, googlesheets4, googledrive, readxl)
rm(list=ls())
#
path <- '../../../data_discovery/USVI_TCRMP/TCRMP_Master_Benthic_Cover_Feb2022.xlsx'
sheets_name <- excel_sheets(path)
benthic_cover <- read_excel(path, sheet="BenthicData")
#
# only use annually sampled data
benthic_cover_annual <- benthic_cover %>% filter(Period=="Annual") %>% select(-Period, -FilmDate, -NoPts, -AnalysisBy, -AnalysisDate)
#
benthic_cover_long <- pivot_longer(benthic_cover_annual, cols = -c(SampleYear, SampleMonth, Location, Transect), names_to = "species", values_to = "abundance") %>% filter(abundance > 0 & !is.na(abundance))
#
benthic_cover_long <- benthic_cover_long %>% rename(year=SampleYear, month=SampleMonth, site=Location, plot=Transect)
benthic_cover_out  <- benthic_cover_long %>% mutate(taxa_type="producer", ecosystem="aquatic", habitat='marine', biome='tropic', guild='benthic producer', unit_abundance='%', scale_abundance='per transect', unique_ID=paste(site, habitat, plot, sep='_'))
#
write.csv(benthic_cover_out, 'harmonized_data/USVI_benthic_cover.csv', row.names = F)
#
```

